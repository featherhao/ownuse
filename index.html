<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<title>常用工具集合</title>
<style>
body{font-family:Arial;margin:40px}h1{color:#333}ul{list-style:none;padding:0}li{margin-bottom:10px}a{color:#0066cc;text-decoration:none}a:hover{text-decoration:underline}
</style>
</head>
<body>
<h1>常用工具集合</h1>
<ul id="toolsList"></ul>

<h2>管理员添加新工具</h2>
<input id="toolName" placeholder="工具名称" />
<input id="toolUrl" placeholder="工具链接" />
<input type="password" id="adminPassword" placeholder="管理员密码" />
<button id="addToolBtn">添加工具</button>

<script>
const listEl = document.getElementById('toolsList')
const nameInput = document.getElementById('toolName')
const urlInput = document.getElementById('toolUrl')
const pwdInput = document.getElementById('adminPassword')
const btn = document.getElementById('addToolBtn')

async function loadTools() {
  const res = await fetch('/api/tools')
  const tools = await res.json()
  listEl.innerHTML = ''
  tools.forEach(t => {
    const li = document.createElement('li')
    const a = document.createElement('a')
    a.href = t.url
    a.target = '_blank'
    a.textContent = t.name
    li.appendChild(a)
    listEl.appendChild(li)
  })
}

btn.addEventListener('click', async () => {
  const name = nameInput.value.trim()
  const url = urlInput.value.trim()
  const password = pwdInput.value
  if(!name || !url || !password){ alert('请填写完整'); return }

  const res = await fetch('/api/tools', {
    method:'POST',
    headers:{'Content-Type':'application/json'},
    body: JSON.stringify({ name, url, password })
  })
  const data = await res.json()
  if(data.success){
    alert('添加成功')
    nameInput.value=''; urlInput.value=''; pwdInput.value=''
    loadTools()
  } else {
    alert('添加失败：'+(data.message||'未知错误'))
  }
})

loadTools()
</script>
</body>
</html>
